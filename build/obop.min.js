/*! obop 0.0.4 */
!function(a){if("function"==typeof bootstrap)bootstrap("obop",a);else if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeObop=a}else"undefined"!=typeof window?window.obop=a():global.obop=a()}(function(){return function(a,b,c){function d(c,f){if(!b[c]){if(!a[c]){var g="function"==typeof require&&require;if(!f&&g)return g(c,!0);if(e)return e(c,!0);throw new Error("Cannot find module '"+c+"'")}var h=b[c]={exports:{}};a[c][0].call(h.exports,function(b){var e=a[c][1][b];return d(e?e:b)},h,h.exports)}return b[c].exports}for(var e="function"==typeof require&&require,f=0;f<c.length;f++)d(c[f]);return d}({1:[function(a,b){function c(){return this instanceof c?void 0:new c}var d=a("./lib/dollar_where"),e=a("./lib/dollar_update");c.where=c.prototype.where=a("./lib/where.js").where,c.view=c.prototype.view=a("./lib/view.js").view,c.order=c.prototype.order=a("./lib/order.js").order,c.update=c.prototype.update=a("./lib/update.js").update,c.system=c.prototype.system=a("./lib/system.json"),c.$where=c.prototype.$where=new d,c.$update=c.prototype.$update=new e,b.exports=c},{"./lib/where.js":2,"./lib/view.js":3,"./lib/order.js":4,"./lib/update.js":5,"./lib/system.json":6,"./lib/dollar_where":7,"./lib/dollar_update":8}],2:[function(a,b,c){function d(a){function b(a){Object.keys(a).forEach(function(b){if(!v){var d=a[b],f=c.where(d);if(f){if(f instanceof Error)return v=f,void 0;var g=function(a){return f(a[b])};g&&e.push(g)}}})}var c=this,d=null;if("function"==typeof a)return a;if(a=a||{},"object"!=typeof a)return new Error("Invalid where operator type: "+a);var e=[],g={},h={},i={};for(var j in a){var k=a[j],l=j.indexOf("."),m=c.$where[j];if(m){var n=m(k,c,j);n&&e.push(n)}else if(l>-1){var o=j.substr(0,l),p=j.substr(l+1);h[o]=h[o]||{},h[o][p]=k}else{if(k instanceof Array)return new Error("Unknown where operator: "+j);"object"==typeof k?i[j]=k:g[j]=k}}var q=Object.keys(g);if(1==q.length){var r=q[0],s=a[r],t=function(a){return"object"==typeof a&&a[r]==s};e.push(t)}else if(q.length>1){var u=function(a){if("object"!=typeof a)return!1;for(var b in g)if(a[b]!=g[b])return!1;return!0};e.push(u)}var v;return b(h),b(i),v?new Error(v):e.length<2?e.shift()||d:f(e)}function e(a){for(var b=a.length,c=0;b>c;c++){var d=a[c];if(d instanceof Error)return d}}function f(a){var b=a.length;return e(a)||function(c){for(var d=0;b>d;d++){var e=a[d];if(!e(c))return!1}return!0}}c.where=function(a,b){var c,e=arguments.length;if(1==e){if(c=d.call(this,a),c instanceof Error)throw c;return c}if(2==e){if(a instanceof Array){if(c=d.call(this,b),c instanceof Error)throw c;return a.filter(c)}throw new Error("Invalid argument type: "+a)}throw new Error("Invalid arguments length: "+e)}},{}],3:[function(a,b,c){function d(a){var b=null;if("function"==typeof a)return a;if(a=a||{},"object"!=typeof a)return new Error("Invalid update operator type: "+a);var c=Object.keys(a);if(!c.length)return b;if(1==c.length){var d=c[0];if(a[d])return function(a){var b={};return a.hasOwnProperty(d)&&(b[d]=a[d]),b}}var e,f={};for(var g in a)a[g]?e=!0:f[g]=!0;return e?function(b){var c={};return Object.keys(b).forEach(function(d){a[d]&&(c[d]=b[d])}),c}:function(a){var b={};return Object.keys(a).forEach(function(c){f[c]||(b[c]=a[c])}),b}}c.view=function(a,b){var c,e=arguments.length;if(1==e){if(c=d.call(this,a),c instanceof Error)throw c;return c}if(2==e){if(a instanceof Array){if(c=d.call(this,b),c instanceof Error)throw c;return a.map(c)}throw new Error("Invalid argument type: "+a)}throw new Error("Invalid arguments length: "+e)}},{}],4:[function(a,b,c){function d(a){function b(a,b){return a[c]<b[c]?-d:a[c]>b[c]?d:0}var c,d,e=null;if("function"==typeof a)return a;if(a=a||{},"object"!=typeof a)return new Error("Invalid order operator type: "+a);if(a instanceof Array){var f;if(a.forEach(function(a){f||a instanceof Array&&2===a.length&&"undefined"!=typeof a[0]&&0===a[1]-a[1]||(f=new Error("Invalid order pair: "+a))}),f)return f;if(0===a.length)return e;if(1===a.length)return c=a[0][0],d=a[0][1],b;var g=a.length;return function(b,c){for(var d=0;g>d;d++){var e=a[d][0],f=a[d][1];if(b[e]<c[e])return-f;if(b[e]>c[e])return f}}}var h=Object.keys(a);return 0===h.length?e:1===h.length&&(c=h[0],d=a[c],h[c])?b:function(b,c){for(var d in a){var e=a[d];if(b[d]<c[d])return-e;if(b[d]>c[d])return e}}}c.order=function(a,b){var c,e=arguments.length;if(1==e){if(c=d.call(this,a),c instanceof Error)throw c;return c}if(2==e){if(a instanceof Array){if(c=d.call(this,b),c instanceof Error)throw c;return a.sort(c)}throw new Error("Invalid argument type: "+a)}throw new Error("Invalid arguments length: "+e)}},{}],5:[function(a,b,c){function d(a){var b,c=this,f=null;if("function"==typeof a)return a;if(a=a||{},!Object.keys(a))return f;if("object"!=typeof a)return new Error("Invalid update operator type: "+d);var g=[];return Object.keys(a).forEach(function(d){if(!b){var e=c.$update[d];if(!e)return b=new Error("Unknown update operator: "+d),void 0;var f=a[d],h={},i={};for(var j in f){var k=f[j],l=j.indexOf(".");if(l>-1){var m=j.substr(0,l),n=j.substr(l+1);i[m]=i[m]||{},i[m][n]=k}else h[j]=k}if(Object.keys(h).length){var o=e(h);g.push(o)}Object.keys(i).length&&Object.keys(i).forEach(function(a){var b={};b[d]=i[a];var e=c.update(b),f=function(b){var c=b[a];return"object"!=typeof c&&(c=b[a]={}),b[a]=e(c),b};g.push(f)})}}),b?b:g.length<2?g.shift()||f:e(g)}function e(a){var b=a.length;return function(c){for(var d=0;b>d;d++){var e=a[d];c=e(c)}return c}}c.update=function(a,b){var c,e=arguments.length;if(1==e){if(c=d.call(this,a),c instanceof Error)throw c;return c}if(2==e){if(a instanceof Array){if(c=d.call(this,b),c instanceof Error)throw c;return a.map(c)}throw new Error("Invalid argument type: "+a)}throw new Error("Invalid arguments length: "+e)}},{}],6:[function(a,b){b.exports={name:"obop",version:"0.0.4"}},{}],7:[function(a,b){function c(){return this instanceof c?void 0:new c}function d(a){for(var b=a.length,c=0;b>c;c++){var d=a[c];if(d instanceof Error)return d}}function e(a){var b=a.length;return d(a)||function(c){for(var d=0;b>d;d++){var e=a[d];if(!e(c))return!1}return!0}}function f(a){var b=a.length;return d(a)||function(c){for(var d=0;b>d;d++){var e=a[d];if(e(c))return!0}return!1}}b.exports=c,c.prototype={$gt:function(a){return function(b){return b>a}},$gte:function(a){return function(b){return b>=a}},$in:function(a){var b=a.length;return function(c){for(var d=0;b>d;d++)if(c==a[d])return!0;return!1}},$lt:function(a){return function(b){return a>b}},$lte:function(a){return function(b){return a>=b}},$ne:function(a){return function(b){return b!=a}},$nin:function(a){var b=a.length;return function(c){for(var d=0;b>d;d++)if(c==a[d])return!1;return!0}},$or:function(a,b){if(a){a instanceof Array||(a=[a]);var c=[];return a.forEach(function(a){var d=b.where(a);c.push(d)}),f(c)}},$and:function(a,b){if(a){a instanceof Array||(a=[a]);var c=[];return a.forEach(function(a){var d=b.where(a);c.push(d)}),e(c)}},$not:function(a,b){var c=b.where(a);return function(a){return!c(a)}},$exists:function(a){return function(b){var c="undefined"!=typeof b;return c===a}},$size:function(a){return function(b){var c,d="undefined"!=typeof b;return d?b instanceof Array?(c=b.length,c==a):!1:!1}}}},{}],8:[function(a,b){function c(){return this instanceof c?void 0:new c}b.exports=c,c.prototype={$set:function(a){return function(b){if("object"!=typeof b)return b;for(var c in a)b[c]=a[c];return b}},$unset:function(a){return function(b){if("object"!=typeof b)return b;for(var c in a)delete b[c];return b}},$rename:function(a){return function(b){if("object"!=typeof b)return b;for(var c in a){var d=b[c];if("undefined"!=typeof d){delete b[c];var e=a[c];b[e]=d}}return b}},$push:function(a){return function(b){if("object"!=typeof b)return b;for(var c in a){var d=a[c],e=b[c];e instanceof Array||(b[c]="undefined"==typeof e?[]:[e]),b[c].push(d)}return b}},$pull:function(a){return function(b){if("object"!=typeof b)return b;for(var c in a){var d=a[c],e=b[c];if(e instanceof Array){for(var f=[],g=e.length,h=0;g>h;h++){var i=e[h];d!=i&&f.push(i)}b[c]=f}else d==e&&(b[c]=[])}return b}},$inc:function(a){return function(b){if("object"!=typeof b)return b;for(var c in a){var d=a[c],e=b[c];d=parseFloat(d)||0,e=parseFloat(e)||0,b[c]=e+d}return b}}}},{}]},{},[1])(1)});